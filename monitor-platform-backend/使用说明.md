# 监控平台使用说明

## 概述

本监控平台是一个基于 Spring Boot 的运维监控系统，支持服务监控、服务器管理、异常检测和智能问答等功能。

## 功能特性

### 1. 监控大屏 (Dashboard)
访问地址: `http://localhost:8080/dashboard.html`

提供系统整体视图，包括：
- 服务总数和在线服务数
- 服务器总数和在线服务器数
- 最近24小时和今日异常事件统计
- 按严重级别分类的异常统计（高/中/低）
- 按环境统计的服务分布
- 按类型统计的服务器分布
- 最近异常事件列表
- 服务指标趋势（平均响应时间、最大/最小响应时间）

数据每30秒自动刷新一次。

### 2. 服务监控
访问地址: `http://localhost:8080/index.html`

主要功能：
- 查看服务列表
- 创建新服务
- 查看服务详细信息
- 生成模拟监控指标
- 触发异常检测
- 查看最近指标数据和异常事件

使用步骤：
1. 在左侧服务列表中选择或创建一个服务
2. 点击"生成模拟指标"创建测试数据
3. 点击"触发异常检测"分析指标并识别异常
4. 在右侧查看指标数据和异常事件

### 3. 服务器管理
访问地址: `http://localhost:8080/server.html`

主要功能：
- 查看所有服务器列表
- 添加新服务器
- 查看服务器实时资源使用情况（CPU、内存、磁盘）
- 采集服务器资源数据
- 刷新服务器数据
- 删除服务器

服务器类型：
- app: 应用服务器
- db: 数据库服务器
- cache: 缓存服务器
- message-queue: 消息队列
- storage: 存储服务器

资源显示：
- CPU使用率（进度条，绿色<60%，黄色60-80%，红色>80%）
- 内存使用率和使用量（GB）
- 磁盘使用率和使用量（GB）
- 负载平均值
- 网络入/出流量（MB/s）

使用步骤：
1. 点击"添加服务器"按钮
2. 填写服务器信息（名称、IP、类型、环境、资源规格等）
3. 点击"保存"创建服务器
4. 点击"采集资源"生成模拟资源使用数据

### 4. MCP智能问答
访问地址: `http://localhost:8080/chat.html`

主要功能：
- 自然语言查询监控数据
- 快捷问题推荐
- 实时对话交互

支持的查询类型：

1. **服务相关**
   - "有多少个服务？"
   - "列出所有服务"
   - "生产环境有多少服务？"
   - "测试环境有多少服务？"

2. **服务器相关**
   - "有多少台服务器？"
   - "在线服务器数量"
   - "服务器列表"
   - "按类型统计服务器"

3. **异常事件**
   - "最近的异常事件"
   - "高严重级别异常"
   - "异常事件数量"

4. **资源使用**
   - "CPU使用情况"
   - "内存使用情况"
   - "磁盘使用情况"
   - "服务器资源使用情况"

5. **健康状态**
   - "系统健康状态"
   - "系统状态如何"

6. **统计概览**
   - "系统统计"
   - "系统概览"

使用步骤：
1. 在输入框中输入问题或点击快捷问题标签
2. 点击"发送"按钮或按Enter键提交问题
3. 查看系统返回的回答

## API接口说明

### Dashboard API

#### 获取大屏汇总数据
```
GET /api/dashboard/summary
```

返回DashboardSummary对象，包含所有统计数据。

### Server API

#### 获取服务器列表
```
GET /api/servers
GET /api/servers?status=online
GET /api/servers?type=app
GET /api/servers?env=prod
```

#### 获取单个服务器
```
GET /api/servers/{id}
```

#### 创建服务器
```
POST /api/servers
Content-Type: application/json

{
  "name": "Web服务器-01",
  "ip": "192.168.1.101",
  "type": "app",
  "env": "prod",
  "cpuCores": 8,
  "totalMemory": 16.0,
  "totalDisk": 500.0,
  "status": "online"
}
```

#### 更新服务器
```
PUT /api/servers/{id}
```

#### 删除服务器
```
DELETE /api/servers/{id}
```

#### 获取服务器资源数据
```
GET /api/servers/{id}/resources?limit=50
```

#### 获取最新资源数据
```
GET /api/servers/{id}/resources/latest
```

#### 采集服务器资源数据
```
POST /api/servers/{id}/resources/collect
Content-Type: application/json

{
  "count": 30
}
```

### Chat API

#### 智能问答
```
POST /api/chat/query
Content-Type: application/json

{
  "query": "有多少个服务？"
}
```

返回:
```json
{
  "response": "当前共有 2 个服务。"
}
```

## 数据存储

所有数据以JSON格式存储在 `data/` 目录下：

- `services.json` - 服务信息
- `servers.json` - 服务器信息
- `metrics.json` - 服务监控指标
- `anomalies.json` - 异常事件
- `server-resources.json` - 服务器资源数据

## 启动和访问

### 启动后端服务
```bash
mvn spring-boot:run
```

或编译后运行：
```bash
mvn clean package
java -jar target/monitor-platform-backend-0.0.1-SNAPSHOT.jar
```

### 访问应用
服务默认运行在 `http://localhost:8080`

- 监控大屏: `http://localhost:8080/dashboard.html`
- 服务监控: `http://localhost:8080/index.html`
- 服务器管理: `http://localhost:8080/server.html`
- 智能问答: `http://localhost:8080/chat.html`

## 技术栈

- **后端**: Spring Boot 2.3.3
- **前端**: 原生HTML/CSS/JavaScript
- **数据存储**: JSON文件
- **构建工具**: Maven

## 注意事项

1. 首次启动时，数据文件会自动创建（如果不存在）
2. 生成的模拟数据用于演示，生产环境需要接入真实的监控数据
3. 大屏数据每30秒自动刷新一次
4. 服务器资源数据需要手动点击"采集资源"按钮生成
5. 智能问答基于规则匹配，暂不支持复杂的自然语言理解

## 未来扩展

- [ ] 集成真实的监控系统（Prometheus、Grafana等）
- [ ] 支持更多监控指标（QPS、错误率、吞吐量等）
- [ ] 增加告警通知功能
- [ ] 支持数据可视化图表
- [ ] 集成真正的AI问答系统
- [ ] 支持用户权限管理
- [ ] 添加数据导出功能

## 联系方式

如有问题或建议，请联系开发团队。
